# Interior Design Evaluator Implementation Plan

## Overview
The core value proposition of MIYAR is to bridge the gap between interior designers (vision, aesthetics, briefs) and developers/investors (numbers, budget, ROI). Currently, the app has disconnected pieces (market intelligence, sustainability data, materials database). 

We need to build a **Design Evaluator Engine** that takes a qualitative design brief (text, images, or selections), structures it into quantitative data (materials, finishes, brand tiers), and runs structural analytics to generate a priced, evaluated output for the investor.

## Proposed Changes

### 1. Database Schema (`drizzle/schema.ts`)
We need to model the evaluation of a design brief.
*   **[NEW] `designBriefs` table**: To store the input (vision, target audience, style).
*   **[NEW] `designSpecifications` table**: To store the structured output generated by AI (selected materials, finishes, estimated quantities, quality tier).
*   **[NEW] `evaluationOutputs` table**: To store the final financial and structural analytics (estimated cost, sustainability score, market fit score).

### 2. Server Backend (AI Engine & Pricing)
*   **[NEW] `server/routers/design-evaluator.ts`**: The core tRPC router for this feature.
    *   `evaluateBrief`: Endpoint that takes text/parameters, calls Gemini/NotebookLM to extract specifications (brands, materials, space requirements).
    *   `calculateAnalytics`: Endpoint that takes the specifications, crosses them with `material_constants` and market data, and generates pricing and viability scores.
*   **[MODIFY] `server/_core/index.ts`**: Register the new `designEvaluator` router.

### 3. Frontend Pages & Components
*   **[NEW] `client/src/pages/DesignEvaluator.tsx`**: The main interface for this feature.
    *   **Step 1: Input**: A rich form for designers to input their brief, target audience, and vision.
    *   **Step 2: AI Processing**: A loading state with micro-animations showing the AI structuring the brief.
    *   **Step 3: Output Dashboard**: A split view showing the structured design specs (for the designer) alongside the financial/structural analytics (for the developer).
*   **[MODIFY] `client/src/components/Sidebar.tsx`**: Add "Design Evaluator" to the navigation.

## Verification Plan

### Automated Tests
*   **Unit Tests (`server/design-evaluator.test.ts`)**: Test the pricing logic by passing mock structured specifications and ensuring the calculated costs align with `material_constants` math.
*   **E2E Tests (`e2e/design-evaluator.spec.ts`)**: Use Playwright to simulate submitting a design brief and verifying that the output dashboard renders with pricing charts and material breakdowns.

### Manual Verification
1.  Navigate to the new "Design Evaluator" page.
2.  Input a sample brief: "High-end luxury minimalist apartment targeting expats. Focus on marble, brass accents, and smart home tech."
3.  Click "Evaluate".
4.  Verify that the AI successfully categorizes this into "Luxury" tier and selects appropriate materials (stone, metal) with high cost estimates.
5.  Verify the structural analytics show a realistic estimated budget per square meter based on our `material_constants` data.
